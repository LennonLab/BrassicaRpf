---
title: "Arabidopsis plate biomass"
author: "Venus Kuo"
date: "August 19, 2017"
output: html_document
---

# 1) Question: Does Rpf alter plant productivity and fitness directly or indirectly?

Rpf treatment to soil decreased plant biomass, but I wanted to test whether Rpf protein had a direct effect on plant biomass. 

I plated sterile A. thaliana plants on agar media for 5 weeks and applied Rpf protein directly to the plate every week. I recorded plate pictures and measured relative biomass using Adobe Photoshop 2017 cc. 

# 2) Set up work environment  

```{r, message=FALSE, warning=FALSE}
# Setup work enviroment 
rm(list = ls())
setwd("~/../Github/BrassicaRpf/data")

# Load dependencies # 
package.list <- c('vegan', 'ggplot2', 'plyr') 
for (package in package.list) {
  if (!require(package, character.only=T, quietly=T)) { 
    install.packages(package)
    library(package, character.only=T)
  } }
```

# 3) Describe and load data set

Read text file of relative biomass fo A. thaliana on plates between Rpf+ and Rpf- treatment.

```{r}
# Read text file #
seedling <- read.delim("~/../Github/BrassicaRpf/data/seedlingbiomass.txt", sep = ",", head = TRUE)

# Look at data set # 
str(seedling)

# Calculate relative biomass # 
seedling$Biomass <- (seedling$BiomassPixel)/(seedling$PlatePixel)
seedling$RelativeBiomass <- (seedling$Biomass)/(seedling$Seedlings)*100
```

# 4) Plot bargraph of A. thaliana biomass with treatment

```{r}
# Calculate biomass means and standard errors of the means # 
seedling.means.sem <- ddply(seedling, c("Treatment"), summarise,
                   mean=mean(RelativeBiomass), sem=sd(RelativeBiomass)/sqrt(length(RelativeBiomass)))
seedling.means.sem <- transform(seedling.means.sem, lower=mean-sem, upper=mean+sem)

# Bargraph #
seedling.barplot <- ggplot(seedling.means.sem, aes(x=Treatment,y = mean)) + 
  geom_bar(width=0.5, colour="black", fill="white" , position = position_dodge(width = 0.65), stat = "identity", size=1)

# Clean Bargraph figure #
seedling.barplot + geom_errorbar(aes(ymax=upper, ymin=lower),
                              position=position_dodge(0.65), data=seedling.means.sem, width = 0.2, size=1) +
  labs(x="Treatment", y="Relative Biomass") +
  theme_classic() +
  scale_fill_manual(values=c("White", "Black")) +
  theme(axis.text.y=element_text(colour="black", size=16),
        axis.text.x=element_text(colour="black", size =14),
        axis.title=element_text(size=18),
        axis.title.y = element_text(colour="black",  margin = margin(0,15,0,10)),
        axis.title.x = element_text(colour="black",margin=margin(10,0,0,0)),
        panel.border = element_rect(linetype = "solid", colour = "black", size=1.5, fill=NA),
        axis.ticks.length = unit(.25, "cm"),
        axis.ticks = element_line(size = 1.5),
        legend.title = element_text(size=18),
        legend.text=element_text(size=18))

```

# 5) Statistical test of relative biomass

```{r}
anova <- aov(seedling$RelativeBiomass ~ seedling$Treatment, data = seedling)
summary(anova) # Treatment significantly affected OD600
TukeyHSD(anova) # 2.02 dif increase from E54A to WT Rpf
```




