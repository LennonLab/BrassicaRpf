---
title: "Brassica Plant"
author: "Venus Kuo"
date: "Feb 26, 2018"
output: pdf_document
---

# 1) Question

How does resuscitating the microbial seed bank affect plant traits?


# 2) Methods

- I performed a factoral experiment testing the effect of Rpf (Rpf-/+) and soil sterilization (live/sterilized) treatment on plant reproductive and   biomass production. 


# 3) Set working environment and load packages

```{r, message=FALSE, warning=FALSE}
# Set working directory #
rm(list = ls())
getwd()
setwd("~/../Github/BrassicaRpf/data") # Specific to Venus's computer

# Require or install packages #
package.list <- c('vegan', 'nlme' ,'data.table', 'plyr', 'reshape', 'reshape2', 'ggplot2') 
for (package in package.list) {
  if (!require(package, character.only=T, quietly=T)) { 
    install.packages(package)
    library(package, character.only=T)
  } }
```


# 4) Load and describe data set

plantfitness : ID, Treatment (Rpf+/Rpf-), soil type (live/sterilized), flower.count, seed.count, SLA (Specific leaf area), height, abiomass (above ground biomass), bbiomass (below ground biomass), dweight (dry weight), wweight (wet weight), shoot.root (shoot:root ratio), total.biomass

```{r, message=FALSE, warning=FALSE}
setwd("~/../Github/BrassicaRpf/data") 

# Load txt file # 
data <- read.delim("plantfitness.txt", sep = ",", header = TRUE)

# Remove incorrectly handled sample #
data <- data[-33, ] 
```


# 5) Brassica rapa reproductive output figure and statistics

## Bargraph: Seed Production

```{r}
# Calculating standard error #
seed.mean.sem <- ddply(data, c("Treatment", "soil"), summarise, 
                   mean=mean(seed.count), sem=sd(seed.count)/sqrt(length(seed.count)))
seed.mean.sem <- transform(seed.mean.sem, lower=mean-sem, upper=mean+sem) 

# Barplot of mean seed counts #
seed.mean.barplot <- ggplot(seed.mean.sem, aes(x=soil, y = mean, fill = Treatment)) + 
  geom_bar(width=0.5, colour = "black", position = position_dodge(width = 0.65), stat = "identity", size=1)

# Plotting bar graph with standard error #
seed.mean.barplot + geom_errorbar(aes(ymax=upper, ymin=lower),
                              position = position_dodge(width = 0.65), data=seed.mean.sem, width = 0.2, size = 1) +
  labs(x = "Soil Type", y="Seeds Produced/Plant") +
  theme_classic() +
  scale_fill_manual(values=c("White", "Black")) +
  theme(axis.text.y=element_text(colour="black", size=18),
        axis.text.x=element_text(colour="black", size =20),
        axis.title=element_text(size=22),
        axis.title.y = element_text(colour="black",  margin = margin(0,10,0,10)),
        axis.title.x = element_text(colour="black",  margin = margin(15,10,0,10)),
        panel.border = element_rect(linetype = "solid", colour = "black", size=3, fill=NA),
        axis.ticks.length = unit(.25, "cm"),
        axis.ticks = element_line(size = 2),
        legend.title = element_text(size=18),
        legend.text=element_text(size=18)) +
  annotate("text", x =0.575, y=87, label = c("A"), size=12)
```

## Statistics: Seed count

```{r}
# Two-factor ANOVA of the effect of treatment and soil type on seed count # 
seed.aov <- anova(lm(seed.count ~ Treatment*soil, data=data))
seed.aov
# Results: Marginally significant main effect of sterilization p = 0.056
# No significant main effect of Rpf or interaction effect
```


## Bargraph: Flower Production

```{r}
# Flower Production # 
# Calculating standard error of the mean for flower production # 
flower.mean.sem <- ddply(data, c("Treatment", "soil"), summarise,
                   mean=mean(flower.count), sem=sd(flower.count)/sqrt(length(flower.count)))
flower.mean.sem <- transform(flower.mean.sem, lower=mean-sem, upper=mean+sem)

# Barplot of flower production by soil type and treatment
flower.mean.barplot <- ggplot(flower.mean.sem, aes(x=soil, y = mean, fill = Treatment)) + 
  geom_bar(width=0.5, colour = "black", position = position_dodge(width = 0.65), stat = "identity", size=1)

# Plotting bar graph with standard error #
flower.mean.barplot + geom_errorbar(aes(ymax=upper, ymin=lower),
                              position=position_dodge(.65), data=flower.mean.sem, width = 0.2, size=1) +
  labs(x = "Soil Type" , y="Flowers Produced/Plant") +
  theme_classic() +
  scale_fill_manual(values=c("White", "Black")) +
  theme(axis.text.y=element_text(colour="black", size=18),
        axis.text.x=element_text(colour="black", size =20),
        axis.title=element_text(size=22),
        axis.title.y = element_text(colour="black",  margin = margin(0,10,0,10)),
        axis.title.x = element_text(colour="black",  margin = margin(15,10,0,10)),
        panel.border = element_rect(linetype = "solid", colour = "black", size=3, fill=NA),
        axis.ticks.length = unit(.25, "cm"),
        axis.ticks = element_line(size = 2),
        legend.title = element_text(size=18),
        legend.text=element_text(size=18)) +
 annotate("text", x =0.575, y=12.5, label = c("B"), size=12)
```

## Statistics: Flower count

```{r}
# Two-factor ANOVA of the effect of treatment and soil type on seed count # 
flower.aov <- anova(lm(flower.count ~ Treatment*soil, data=data))
flower.aov
# Results: No significant main or interaction effects
```


# 6) Brassica rapa total plant biomass 

## Bargraph: Total Plant Biomass

```{r}
# Calculating standard error of means for total plant biomass #
plantmeans.sem <- ddply(data, c("soil", "Treatment"), summarise,
                   mean=mean(total.biomass), sem=sd(total.biomass)/sqrt(length(total.biomass)))
plantmeans.sem <- transform(plantmeans.sem, lower=mean-sem, upper=mean+sem)

# Barplot of total plant biomass #
plantmeans.barplot<- ggplot(plantmeans.sem, aes(x= soil , y = mean, fill = Treatment)) + 
   geom_bar(width=0.5, colour="black", position = position_dodge(width = 0.65), stat = "identity", size=1)

# Barplot of total plant biomass with sem added # 
plantmeans.barplot + geom_errorbar(aes(ymax=upper, ymin=lower),
                              position=position_dodge(0.65), data=plantmeans.sem, width = 0.2, size=1) +
  labs(x = "Soil Type", y="Total Plant Biomass (g)") +
  theme_classic() +
  scale_fill_manual(values=c("White", "Black")) +
  theme(axis.text.y=element_text(colour="black", size=18),
        axis.text.x=element_text(colour="black", size =20),
        axis.title=element_text(size=22),
        axis.title.y = element_text(colour="black",  margin = margin(0,10,0,10)),
        axis.title.x = element_text(colour="black",margin=margin(15,1,0,10)),
        panel.border = element_rect(linetype = "solid", colour = "black", size=3, fill=NA),
        axis.ticks.length = unit(.25, "cm"),
        axis.ticks = element_line(size = 2),
        legend.title = element_text(size=18),
        legend.text=element_text(size=18)) +
  annotate("text", x =0.575, y=2.055, label = c("A"), size=12)
```

## Statistics: Total plant biomass

```{r}
# Total biomass # 
# Test of normality # 
#qqnorm(data$total.biomass)
#shapiro.test(data$total.biomass)
# Results: p = 0.063, data is normal # 

# Two-factor ANOVA of total biomass with treatment and soil type # 
plant.t.aov <- anova(lm(total.biomass ~ Treatment*soil, data=data))
plant.t.aov
# Results: Significant main effect of Rpf, p = 0.0028
# Non-significant main effect of soil and interaction effect
```

# 7) Brassica rapa below-ground (root) biomass 

## Bargraph: Root Biomass

```{r}
# Calculating standard error of means for total plant biomass #
plantmeans.sem <- ddply(data, c("Treatment", "soil"), summarise,
                   mean=mean(bbiomass), sem=sd(bbiomass)/sqrt(length(bbiomass)))
plantmeans.sem <- transform(plantmeans.sem, lower=mean-sem, upper=mean+sem)

# Plotting bar graph # 
live.biomass.bar <- ggplot(plantmeans.sem, aes(x = soil, y = mean, fill = Treatment)) + 
  geom_bar(width=0.5, colour="black", position = position_dodge(width = 0.65), stat = "identity", size=1)

# Plotting bargraph # 
live.biomass.bar  + geom_errorbar(aes(ymax=upper, ymin=lower),
                              position=position_dodge(0.65), data=plantmeans.sem, width = 0.2, size=1) +
  labs(x="Treatment", y="Plant root biomass (g)") +
  theme_classic() +
  scale_fill_manual(values=c("White", "Black")) +
  theme(axis.text.y=element_text(colour="black", size=18),
        axis.text.x=element_text(colour="black", size =18),
        axis.title=element_text(size=22),
        axis.title.y = element_text(colour="black",  margin = margin(0,10,0,10)),
        axis.title.x = element_text(colour="black",margin=margin(5,0,0,0)),
        panel.border = element_rect(linetype = "solid", colour = "black", size=3, fill=NA),
        axis.ticks.length = unit(.25, "cm"),
        axis.ticks = element_line(size = 2),
        legend.title = element_text(size=18),
        legend.text=element_text(size=18))+
  annotate("text", x =0.55, y=1.1, label = c("b"), size=12)
```

## Stastistics: Root biomass

```{r}
# Two-factor ANOVA of root biomass with treatment and soil type # 
plant.b.aov <- anova(lm(bbiomass ~ Treatment*soil, data=data))
plant.b.aov
# Results: Signficant main effect of Rpf (p=0.012) and sterilization (p=0.049)
# No significant interaction effect
```

# 8) Brassica rapa above-ground biomass 

## Bargraph: Above-ground biomass

```{r}
# Calculating standard error of means for total plant biomass #
plantmeans.a.sem <- ddply(data, c("Treatment", "soil"), summarise,
                   mean=mean(abiomass), sem=sd(abiomass)/sqrt(length(abiomass)))
plantmeans.a.sem <- transform(plantmeans.a.sem, lower=mean-sem, upper=mean+sem)

# Barplot of total plant biomass #
plantmeans.a.barplot <- ggplot(plantmeans.a.sem, aes(x = soil, y = mean, fill = Treatment)) + 
  geom_bar(width=0.5, colour="black", position = position_dodge(width = 0.65), stat = "identity", size=1)

# Bargraph #
plantmeans.a.barplot + geom_errorbar(aes(ymax=upper, ymin=lower),
                              position=position_dodge(0.65), data=plantmeans.a.sem, width = 0.2, size=1) +
  labs(x="Treatment", y="Above-ground biomass (g)") +
  theme_classic() +
  scale_fill_manual(values=c("White", "Black")) +
  theme(axis.text.y=element_text(colour="black", size=18),
        axis.text.x=element_text(colour="black", size =18),
        axis.title=element_text(size=22),
        axis.title.y = element_text(colour="black",  margin = margin(0,10,0,10)),
        axis.title.x = element_text(colour="black",margin=margin(5,0,0,0)),
        panel.border = element_rect(linetype = "solid", colour = "black", size=3, fill=NA),
        axis.ticks.length = unit(.25, "cm"),
        axis.ticks = element_line(size = 2),
        legend.title = element_text(size=18),
        legend.text=element_text(size=18)) +
  annotate("text", x =0.55, y=1.4, label = c("B"), size=12)
```

## Stastistics: Above-ground biomass

```{r}
# Two-factor ANOVA of above-ground biomass with treatment and soil type # 
plant.a.aov <- anova(lm(abiomass ~ Treatment*soil, data=data))
plant.a.aov
# Results: Very signficant main effect of soil (p=0.0001) and marginally significant effect of Rpf (p = 0.075)
# No significant interaction effect
```

# 9) Brassica rapa root:shoot ratio

## Bargraph: Root : Shoot Ratio

```{r}
# Root shoot ratio calculations # 
abio <- data$abiomass
bbio <- data$bbiomass
data$root.shoot.ratio <- abio/bbio

# Calculate means and SEM # 
root.shoot.means.sem <- ddply(data, c("soil", "Treatment"), summarise,
                   mean=mean(root.shoot.ratio), sem=sd(root.shoot.ratio)/sqrt(length(root.shoot.ratio)))
root.shoot.means.sem <- transform(root.shoot.means.sem, lower=mean-sem, upper=mean+sem)

# Bar plot # 
root.shoot.bar <- ggplot(root.shoot.means.sem, aes(x = soil, y = mean, fill = Treatment)) + 
  geom_bar(width=0.5, colour="black", position = position_dodge(width = 0.65), stat = "identity", size=1)

root.shoot.bar  + geom_errorbar(aes(ymax=upper, ymin=lower),
                              position=position_dodge(0.65), data=root.shoot.means.sem, width = 0.2, size=1) +
  labs(x =  "Soil Type" ,y="Root:Shoot Ratio") +
  theme_classic() +
  scale_fill_manual(values=c("White", "Black")) +
  theme(axis.text.y=element_text(colour="black", size=18),
        axis.text.x=element_text(colour="black", size =20),
        axis.title=element_text(size=22),
        axis.title.y = element_text(colour="black",  margin = margin(0,10,0,10)),
        axis.title.x = element_text(colour="black",margin=margin(15,10,0,10)),
        panel.border = element_rect(linetype = "solid", colour = "black", size=3, fill=NA),
        axis.ticks.length = unit(.25, "cm"),
        axis.ticks = element_line(size = 2),
        legend.title = element_text(size=18),
        legend.text=element_text(size=18)) #+
```

## Statistics: Root : Shoot Ratio

```{r}
ratiobiomass.aov <- anova(lm(root.shoot.ratio~soil*Treatment ,data=data))
ratiobiomass.aov
# Results: Significant main effect of sterilization (p = 0.0005)
# Non-significant main effect of Rpf and interaction effect
```


# 10) Plant specific leaf area 

## Bargraph: SLA

```{r}
# Calculate means and SEM # 
SLA.sem <- ddply(data, c("soil", "Treatment"), summarise,
                   mean=mean(SLA), sem=sd(SLA)/sqrt(length(SLA)))
SLA.sem <- transform(SLA.sem, lower=mean-sem, upper=mean+sem)

# Bar plot # 
SLA.bar <- ggplot(SLA.sem, aes(x = soil, y = mean, fill = Treatment)) + 
  geom_bar(width=0.5, colour="black", position = position_dodge(width = 0.65), stat = "identity", size=1)

SLA.bar  + geom_errorbar(aes(ymax=upper, ymin=lower),
                              position=position_dodge(0.65), data=SLA.sem, width = 0.2, size=1) +
  labs(x =  "Soil Type" ,y="Plant SLA") +
  theme_classic() +
  scale_fill_manual(values=c("White", "Black")) +
  theme(axis.text.y=element_text(colour="black", size=18),
        axis.text.x=element_text(colour="black", size =20),
        axis.title=element_text(size=22),
        axis.title.y = element_text(colour="black",  margin = margin(0,10,0,10)),
        axis.title.x = element_text(colour="black",margin=margin(15,10,0,10)),
        panel.border = element_rect(linetype = "solid", colour = "black", size=3, fill=NA),
        axis.ticks.length = unit(.25, "cm"),
        axis.ticks = element_line(size = 2),
        legend.title = element_text(size=18),
        legend.text=element_text(size=18))
```

## Statistics: Plant SLA

```{r}
SLA.aov <- anova(lm(SLA~soil*Treatment, data=data))
SLA.aov
# Results: Non-significant main or interactive effects
```

# 11) Plant Height

## Bargraph: SLA

```{r}
# Calculate means and SEM # 
Height.sem <- ddply(data, c("soil", "Treatment"), summarise,
                   mean=mean(height), sem=sd(height)/sqrt(length(height)))
Height.sem <- transform(Height.sem, lower=mean-sem, upper=mean+sem)

# Bar plot # 
Height.bar <- ggplot(Height.sem, aes(x = soil, y = mean, fill = Treatment)) + 
  geom_bar(width=0.5, colour="black", position = position_dodge(width = 0.65), stat = "identity", size=1)

Height.bar  + geom_errorbar(aes(ymax=upper, ymin=lower),
                              position=position_dodge(0.65), data=Height.sem, width = 0.2, size=1) +
  labs(x =  "Soil Type" ,y="Plant shoot height") +
  theme_classic() +
  scale_fill_manual(values=c("White", "Black")) +
  theme(axis.text.y=element_text(colour="black", size=18),
        axis.text.x=element_text(colour="black", size =20),
        axis.title=element_text(size=22),
        axis.title.y = element_text(colour="black",  margin = margin(0,10,0,10)),
        axis.title.x = element_text(colour="black",margin=margin(15,10,0,10)),
        panel.border = element_rect(linetype = "solid", colour = "black", size=3, fill=NA),
        axis.ticks.length = unit(.25, "cm"),
        axis.ticks = element_line(size = 2),
        legend.title = element_text(size=18),
        legend.text=element_text(size=18))
```

## Statistics: Plant shoot height

```{r}
height.aov <- anova(lm(height~soil*Treatment ,data=data))
height.aov
# Results: Non-significant main or interactive effects
```










