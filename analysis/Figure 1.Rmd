---
title: "Figure1"
author: "Venus Kuo"
date: "June 10, 2017"
output: pdf_document
---

## 1) Questions

How does resuscitating the microbial seed bank affect plant producitivty?

## 2) Experiment methods

In a full factoral experiment treating Brassica rapa plants grown in growth chambers with recombiant Rpf protein in live and sterilized soil. At the end of the six week growth chamber experiment, biomass was determined by dry weight.  

## 3) Set working environment and load packages

```{r, echo = FALSE}
# Set working directory #
rm(list = ls())
getwd()
setwd("C:/Users/Venus/Github/BrassicaRpf/data")

# Require or install packages #
package.list <- c('vegan', 'nlme' ,'data.table', 'plyr', 'reshape', 'reshape2', 'ggplot2') 
for (package in package.list) {
  if (!require(package, character.only=T, quietly=T)) { 
    install.packages(package)
    library(package, character.only=T)
  } }
```

## 4) Load and describe data set

Plant Fitness.csv : Plant attributes collected at end of 6 week growing period. Information include ID number, Treatment (rpf+ = 1, rpf- = 2), soil type (complex = 2, simple = 1), flower.count, seed.count, SLA (Specific leaf area), height, abiomass (above ground biomass), bbiomass (below ground biomass), dweight (dry weight), wweight (wet weight), shoot.root (shoot:root ratio), total.biomass.

```{r}
setwd("C:/Users/Venus/Github/BrassicaRpf/data")
# Load csv files # 
plantfitness <- read.csv("Plant Fitness.csv", header=T)

# Define factor for plantfitness dataframe levels # 
plantfitness$Treatment <- factor(plantfitness$Treatment, levels=c(2,1), labels=c("Rpf-", "Rpf+"))
plantfitness$soil <- factor(plantfitness$soil, levels=c(2,1), labels=c("Live", "Sterilized"))

# Remove compromised replicate #
plantfitness <- plantfitness[-33, ]

# Subsetting live soil data # 
plant.sub <- subset(plantfitness, soil=="Live")
```

## 5) Bar graph visualization of total plant biomass 

```{r}
# Summarize total plant biomass #
plantmeans <- ddply(plant.sub, c("Treatment"), summarise, mean=mean(total.biomass))
# Barplot of total plant biomass #
plantmeans.barplot<- ggplot(plantmeans, aes(x= Treatment ,y = mean, fill = Treatment)) + 
   geom_bar(width=0.5, colour="black", position = position_dodge(width = 0.65), stat = "identity", size=1.5)
# Calculating standard error of means for total plant biomass #
plantmeans.sem <- ddply(plant.sub, c("soil", "Treatment"), summarise,
                   mean=mean(total.biomass), sem=sd(total.biomass)/sqrt(length(total.biomass)))
plantmeans.sem <- transform(plantmeans.sem, lower=mean-sem, upper=mean+sem)
# Barplot of total plant biomass with sem added # 
plantmeans.barplot + geom_errorbar(aes(ymax=upper, ymin=lower),
                              position=position_dodge(0.65), data=plantmeans.sem, width = 0.2, size=1.5) +
  labs(x="Soil type", y="Total plant biomass (g)") +
  theme_classic() +
  scale_fill_manual(values=c("Black", "White")) +
  theme(axis.text.y=element_text(colour="black", size=18),
        axis.text.x=element_text(colour="black", size =18),
        axis.title=element_text(size=22),
        axis.title.y = element_text(colour="black",  margin = margin(0,10,0,10)),
        axis.title.x = element_text(colour="black",margin=margin(5,0,0,0)),
        panel.border = element_rect(linetype = "solid", colour = "black", size=3, fill=NA),
        axis.ticks.length = unit(.25, "cm"),
        axis.ticks = element_line(size = 2),
        legend.title = element_text(size=18),
        legend.text=element_text(size=18)) +
  annotate("text", x =0.55, y=2.1, label = c("A"), size=12)
```

## 6) Stacked bargraph visualization of below and aboveground biomass

```{r}
# Combining the above and belowground biomass # 
plant.m <- melt(plant.sub) 
# Summarizing means of plant biomass data # 
plant.m.means <- ddply(plant.m, c("Treatment", "variable"), summarise, mean=mean(value))
# Plotting stacked bar graph # 
live.biomass.stacked.bar <- ggplot(plant.m.means, aes(x = Treatment, y = mean, fill = variable)) + 
  geom_bar(width=0.5, colour="black", size=1.5, stat = "identity")
# Plotting stacked bargraph # 
live.biomass.stacked.bar + 
  labs(x="Treatment", y="Plant biomass (g)") +
  theme_classic() +
  scale_fill_manual(values=c("White", "Black")) +
  theme(axis.text.y=element_text(colour="black", size=18),
        axis.text.x=element_text(colour="black", size =18),
        axis.title=element_text(size=22),
        axis.title.y = element_text(colour="black",  margin = margin(0,10,0,10)),
        axis.title.x = element_text(colour="black",margin=margin(5,0,0,0)),
        panel.border = element_rect(linetype = "solid", colour = "black", size=3, fill=NA),
        axis.ticks.length = unit(.25, "cm"),
        axis.ticks = element_line(size = 2),
        legend.title = element_text(size=18),
        legend.text=element_text(size=18))+
  annotate("text", x =0.55, y=1.9, label = c("B"), size=12)
```

# ANOVA statistical analysis #

```{r}
plant.t.aov <- anova(lm(total.biomass ~ Treatment*soil, data=plant.sub))
plant.t.aov
# Total plant productivity was significantly (p < 0.005) reduced under Rpf treatment to soil # 

belowground.aov <- anova(lm(bbiomass ~ Treatment*soil, data=plant.sub)

```



